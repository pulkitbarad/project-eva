var pollingIntervalMilli=3000;var nuoEvaMessageHolder={};var nuoUserMessageHolder={};var nuoConversationResponse=null;var mapHolder;var geocoderHolder=null;var placesServiceHolder=null;const entryPosition={lat:52.0933702,lng:6.2846642};const entryZoomLevel=7.5;const searchZoomLevel=17;const clickZoomLevel=18;const markerCircleSize=10;const systemFileLabel="Systeembestand";var activeMarker;var nuoCustomers=[];var activePlaceDetails;var activeLocationDetails;var activeCustomerDetails;var activityPropertyName="Activiteiten";var colorCriDateName="Uitvoeringsdatum";var colorCriStatusName="Status";var colorCriStatusComplete="Opgeleverd";var markerColorGreen="green";var markerColorRed="red";var markerColorOrange="orange";var markerColorBlue="blue";var isExplicitSave=false;var customerSearchKeywords=["klanten","klant"];var conditionPositivePrefix=["met"];var conditionNegativePrefix=["zonder","geen"];var conditionOpEq=["hetzelfde als","is gelijk aan","zijn gelijk aan","="];var conditionOpGt=["meer dan",">"];var conditionOpGtEq=["meer dan of gelijk aan",">=","> ="];var conditionOpLt=["minder dan","<"];var conditionOpLtEq=["minder dan of gelijk aan","<=","< ="];var conditionOpContains=["bevat"];var conditionOpFrom=["uit"];const conditionOperatorType={EQ:"==",GT:">",GT_EQ:">=",LT:"<",LT_EQ:"<=",CONTAINS:"__CONTAINS",FROM:"__FROM",DEFAULT:"__DEFAULT"};var maskedOperands={};var nuoCustomersSample={id:"1",name:"AVAB",value:18,location:{lat:52.1192104,lng:5.039440000000013},files:[{fileName:"Home/",author:"System",sizeBytes:0,dateCreatedMillis:Date.now(),dateModifiedMillis:Date.now()}]};function initUI(){hideCustomerBanner();$("#customerFilesTable").hide();$("#customerFilePath").hide();$("#customerDetailsGrid").hide();$("#mouseOverContainer").hide();$("#activityMenu").hide();$("#activeUsername").text("Welkom "+activeUsername);getCustomers();addCustomerTableEventHandlers();activeCustomerDetails=getNewCustomerDetails();createCustomerDetailsGrid();$("#searchCloseButton").jqxToggleButton({toggled:false,template:"default"});$("#signOutButton").on("click",signOutHandler);$("#fileInput").on("change",uploadFileSeletionHandler);$("#customerFileDeleteButton").on("click",deleteFileSelectionHandler);$("#customerFileNewFolderButton").on("click",newFolderButtonHandler);$("#searchButton").on("click",searchButtonHandler);$("#searchCloseButton").on("click",searchCloseButtonHandler);$("#deleteCustomerButton").on("click",deleteCustomerButtonHandler);$("#customerFilesButton").on("click",customerFilesButtonHandler);$("#placeActionButton").on("click",placeActionButtonHandler);$("#mapResetButton").on("click",mapResetButtonHandler);$("#searchBox").on("keypress",function(a){if(a.keyCode&&a.keyCode==13){searchButtonHandler()}})}function signOutHandler(){directCall("rt73").done(function(a){window.location="https://avab.nuocanvas.ai"})}function getCustomers(){directCall("rt3").done(function(a){if(a.StatusCode&&a.StatusCode===200){if(a.Content&&a.Content.trim().length>0){nuoCustomers=a.Content.trim().split("|~|").map(function(b){return JSON.parse(b)})}initMap()}else{window.location="https://avab.nuocanvas.ai"}})}function deleteFileSelectionHandler(){if(confirm("Weet je zeker dat je geselecteerde bestanden wilt verwijderen?")){var b=$("#customerFilesTable").jqxGrid("getselectedrowindexes");var a=0;b.map(function(c){return $("#customerFilesTable").jqxGrid("getrowdata",c)}).forEach(function(f){var g=f.fileName;if(f.isDirectory){var c=getCustomer(activeCustomerDetails).files.filter(function(i){var h=getParentFilePath();return i.fileName.startsWith(h+f.fileLabel)});deleteFiles(c,a)}else{if(!g.endsWith(systemFileLabel)){var d=getParentFilePath();var e=getCustomerId(activeCustomerDetails);if(e){g="CRM/UserFiles/"+e+"/"+g}$("#customerFilePath").css("background-color","yellow");a+=1;directCall("rt13","NuoFileContent",{FileName:g}).done(function(h){if(h.StatusCode&&h.StatusCode===200){console.log("Delete files status= "+h.Content);getCustomer(activeCustomerDetails).files=getCustomer(activeCustomerDetails).files.filter(function(i){return i.fileName!==f.fileName});loadCustomerFilesTable(getFileList(d));a-=1;if(a==0){writeCustomerDetails();$("#customerFilePath").css("background-color","white")}}else{window.location="https://avab.nuocanvas.ai"}})}}});$("#customerFilesTable").jqxGrid("clearselection")}}function deleteFiles(b,c){var a=c;b.forEach(function(e){var g=e.fileName;var d=getParentFilePath();if(!g.endsWith(systemFileLabel)){var f=getCustomerId(activeCustomerDetails);if(f){g="CRM/UserFiles/"+f+"/"+g}$("#customerFilePath").css("background-color","yellow");a+=1;directCall("rt13","NuoFileContent",{FileName:g}).done(function(h){if(h.StatusCode&&h.StatusCode===200){if(getCustomer(activeCustomerDetails)){getCustomer(activeCustomerDetails).files=getCustomer(activeCustomerDetails).files.filter(function(i){return i.fileName!==e.fileName})}loadCustomerFilesTable(getFileList(d));a-=1;if(a==0){writeCustomerDetails();$("#customerFilePath").css("background-color","white")}}else{window.location="https://avab.nuocanvas.ai"}})}else{getCustomer(activeCustomerDetails).files=getCustomer(activeCustomerDetails).files.filter(function(h){return h.fileName!==e.fileName});loadCustomerFilesTable(getFileList(d))}})}function newFolderButtonHandler(){var d=prompt("Naam van de map","Nieuwe Map");if(d!=null&&d.trim().length>0){var a=getParentFilePath();var b={author:activeUsername,sizeBytes:0,dateCreatedMillis:Date.now(),dateModifiedMillis:Date.now()};var c=d+"/"+systemFileLabel;if(a&&a.length>0&&a!=="/"){c=a+c}b.fileName=c;console.log(JSON.stringify(b));getCustomer(activeCustomerDetails).files.push(b);loadCustomerFilesTable(getFileList(a));writeCustomerDetails()}}function uploadFileSeletionHandler(f){var e=f.target.files;var b=0;for(var d=0,c;c=e[d];d++){var a=new FileReader();a.onload=(function(g){return function(){var h=g.name;var j={author:activeUsername,sizeBytes:g.size,dateCreatedMillis:Date.now(),dateModifiedMillis:Date.now()};var i=getParentFilePath();if(i&&i.length>0&&i!=="/"){h=i+h}j.fileName=h;var k=getCustomerId(activeCustomerDetails);if(k){h="CRM/UserFiles/"+k+"/"+h}$("#customerFilePath").css("background-color","green");$("#customerFilePath").css("color","white");b+=1;directCall("rt7","NuoFileContent",{FileName:h,ContentType:g.type}).done(function(l){if(l.StatusCode&&l.StatusCode===200){console.log("Received presigned url "+l.Content);$.ajax({type:"PUT",url:l.Content,headers:{"Content-Disposition":'attachment; filename="'+g.name+'"'},contentType:g.type,processData:false,data:g,success:function(){console.log(JSON.stringify(j));getCustomer(activeCustomerDetails).files.push(j);loadCustomerFilesTable(getFileList(i));b-=1;writeCustomerDetails();if(b==0){$("#customerFilePath").css("background-color","white");$("#customerFilePath").css("color","black")}},error:function(m){alert("Bestand "+g.name+" kan niet worden geÃ¼pload.");console.log(m);b-=1;if(b==0){writeCustomerDetails();$("#customerFilePath").css("background-color","white");$("#customerFilePath").css("color","black")}}});return false}else{window.location="https://avab.nuocanvas.ai"}})}})(c);a.readAsDataURL(c)}}function getParentFilePath(){var a=$("#customerFilesTable").jqxGrid("getrowdata",0);if(a){return a.parentPath}else{return""}}function placeActionButtonHandler(){if($("#placeActionButton").val()==="Nieuwe Klant"){updateCustomerDetails()}else{if($("#placeActionButton").val()==="Klant Opslaan"){if(activeLocationDetails&&activePlaceDetails){saveCustomerDetails()}removeActiveMarker();createMarkerCircles(nuoCustomers)}}}function deleteCustomerButtonHandler(){if(confirm("Weet u zeker dat u de klant en bestanden wilt verwijderen?")){deleteCustomerOnActiveLocation()}}function customerFilesButtonHandler(){loadCustomerDirWindow(getCustomerName(activeCustomerDetails))}function resetPlaceButtons(){$("#placeActionButton").val("Nieuwe Klant");$("#deleteCustomerButton").hide();$("#customerFilesButton").hide()}function saveCustomerDetails(){isExplicitSave=true;var b=$("#customerDetailsGrid").jqxTreeGrid("getRows");var c=findCustomerOnActiveLocation();if(c){c.customerDetails=b;c.customerDetailsFlat=flattenCustomerDetails(b);c.placeDetails=activePlaceDetails}else{var a={id:"Customer_"+Date.now(),locationDetails:activeLocationDetails,placeDetails:activePlaceDetails,customerDetails:b,customerDetailsFlat:flattenCustomerDetails(b),files:[{fileName:"Offerte/"+systemFileLabel,author:"Systeem",sizeBytes:0,dateCreatedMillis:Date.now(),dateModifiedMillis:Date.now()},{fileName:"Facturen/"+systemFileLabel,author:"Systeem",sizeBytes:0,dateCreatedMillis:Date.now(),dateModifiedMillis:Date.now()},{fileName:"Overige/"+systemFileLabel,author:"Systeem",sizeBytes:0,dateCreatedMillis:Date.now(),dateModifiedMillis:Date.now()}]};nuoCustomers.push(a);$("#customerFilesButton").prop("disabled",false);$("#deleteCustomerButton").prop("disabled",false)}writeCustomerDetails();isExplicitSave=false}function writeCustomerDetails(){directCall("rt5","NuoCrmUserMetadata",nuoCustomers.map(function(b){var a=b;a.customerDetails=transformCustomerDetail(b.customerDetails);return a}).map(function(a){return JSON.stringify(a)}).join("|~|")).done(function(a){if(a.StatusCode&&a.StatusCode===200){if(isExplicitSave){alert("Klantgegevens Opgeslagen.")}}else{window.location="https://avab.nuocanvas.ai"}})}function transformCustomerDetail(a){var b=a.map(function(d){var c={id:d.id,property:d.property,value:d.value,type:d.type};if(d.children&&d.children.length>0){c.children=transformCustomerDetail(d.children)}if(d.sourceValues&&d.sourceValues.length>0){c.sourceValues=d.sourceValues}return c});return b}function findCustomerOnActiveLocation(){var a=nuoCustomers.find(function(b){return JSON.stringify(b.locationDetails)==JSON.stringify(activeLocationDetails)});return a}function deleteCustomerOnActiveLocation(){var a=getCustomer(activeCustomerDetails).files;deleteFiles(a,0);nuoCustomers=nuoCustomers.filter(function(b){return JSON.stringify(b.locationDetails)!=JSON.stringify(activeLocationDetails)});writeCustomerDetails();clearCustomerBanner();$("#customerDirWindow").hide("fast");initMap(mapHolder.getCenter(),mapHolder.getZoom())}function searchButtonHandler(){clearCustomerBanner();var b=$("#searchBox").val();var a=checkIfStartsWithArrayElement(b.toLowerCase(),customerSearchKeywords);if(a){searchCustomers(b.toLowerCase(),a.length)}else{searchAddress(b)}}function checkIfStartsWithArrayElement(c,a){for(var b=0;b<a.length;b++){if(c.startsWith(a[b])){return a[b]}}return null}function searchAddress(a){if(a&&a.length>0&&a.trim().length>0){if(!geocoderHolder){geocoderHolder=new google.maps.Geocoder()}var b=function(e,d){if(d==="OK"){placeMarkerAndPanTo(e[0].geometry.location,e[0].place_id,true)}else{alert("Geocode was not successful for the following reason: "+d)}};var c={address:a};geocoderHolder.geocode(c,b)}}function searchCustomers(h,c){var g=h.substring(c);g=removeConsecutiveWS(g);var e=/"([^\"]+)"/g;var b=e.exec(g);var a=0;while(b){console.log(b[0]);var f="__match_"+a;maskedOperands[f]=b[1].trim();g=g.replace(b[0],f);b=e.exec(g);a+=1}var d=g.split(/\s+en\s+/).map(function(i){return parseCondition(i)});initMap(entryPosition,entryZoomLevel,applyConditions(d))}function flattenCustomerDetails(b){var a=[];b.forEach(function(c){var d={};d.id=c.id;d.type=c.type;d.property=c.property;d.value=c.value;if(d.type==="date"&&d.value){d.value=d.value.toDateMillis()}else{if(d.value&&d.value.toNumber()){d.type="number";d.value=d.value.toNumber()}else{d.value=d.value}}a.push(d);if(c.children&&c.children.length>0){a=a.concat(flattenCustomerDetails(c.children))}});return a}function parseCondition(c){var f=c.trim();var d={input:f,isDate:false,isNegation:false,isNumber:false,operatorType:null,operands:[]};var e=checkIfStartsWithArrayElement(f,conditionPositivePrefix);if(e){f=f.substring(e.length).trim()}e=checkIfStartsWithArrayElement(f,conditionNegativePrefix);if(e){f=f.substring(e.length).trim();d.isNegation=true}var a=checkIfContainsArrayElement(f,conditionOpGtEq);if(a){d.operatorType=conditionOperatorType.GT_EQ}else{a=checkIfContainsArrayElement(f,conditionOpLtEq);if(a){d.operatorType=conditionOperatorType.LT_EQ}else{a=checkIfContainsArrayElement(f,conditionOpEq);if(a){d.operatorType=conditionOperatorType.EQ}else{a=checkIfContainsArrayElement(f,conditionOpGt);if(a){d.operatorType=conditionOperatorType.GT}else{a=checkIfContainsArrayElement(f,conditionOpLt);if(a){d.operatorType=conditionOperatorType.LT}else{a=checkIfContainsArrayElement(f,conditionOpContains);if(a){d.operatorType=conditionOperatorType.CONTAINS}else{a=checkIfContainsArrayElement(f,conditionOpFrom);if(a){d.operatorType=conditionOperatorType.FROM}else{a=conditionOperatorType.DEFAULT;d.operatorType=conditionOperatorType.DEFAULT}}}}}}}if(a){var b=f.split(a).map(function(g){var h=g.trim();if(maskedOperands[h]){return maskedOperands[h]}else{return h}});if(b.length>2){alert("'"+f+"' is geen geldige voorwaarde.")}else{if(d.operatorType==conditionOperatorType.DEFAULT){d.operands.push(b[0])}else{if(d.operatorType==conditionOperatorType.FROM){d.operands.push(b[1])}else{d.operands.push(b[0]);if(b.length>1&&b[1].toNumber()){d.isNumber=true;d.operands.push(b[1].toNumber())}else{if(b.length>1&&b[1].toDateMillis()){d.isDate=true;d.operands.push(b[1].toDateMillis())}else{d.operands.push(b[1])}}}}}}else{alert("'"+f+"' is geen geldige voorwaarde.")}return d}function applyConditions(conditionDetails){var filteredCustomeres=nuoCustomers.filter(function(customer){var filteredConditions=conditionDetails.filter(function(conditionDetail){var operands=conditionDetail.operands;if(operands.length==0){return false}else{if(operands.length>1){var conditionEval=false;var filteredDetails=customer.customerDetailsFlat.filter(function(detail){var result=standardize(detail.property)===standardize(operands[0]);if(result&&detail.value){if(result){if(detail.type==="string"||detail.type==="array"){if(result&&conditionDetail.operatorType==conditionOperatorType.FROM){result=standardize(customer.placeDetails.placeAddress).indexOf(standardize(operands[0]))>=0}else{if(result&&conditionDetail.operatorType==conditionOperatorType.CONTAINS){result=standardize(detail.value).indexOf(standardize(operands[1]))>=0}else{result=eval("'"+standardize(detail.value)+"'"+conditionDetail.operatorType+"'"+standardize(operands[1])+"'")}}}else{result=eval(detail.value+conditionDetail.operatorType+operands[1])}}}else{result=false}return result});conditionEval=filteredDetails.length>0}else{if(conditionDetail.operatorType==conditionOperatorType.FROM){conditionEval=standardize(customer.placeDetails.placeAddress).indexOf(standardize(operands[0]))>=0}else{var filteredDetails=customer.customerDetailsFlat.filter(function(detail){return standardize(detail.property)===standardize(operands[0])&&detail.value});conditionEval=filteredDetails.length>0}}}if(conditionDetail.isNegation){return !conditionEval}else{return conditionEval}});return filteredConditions.length==conditionDetails.length});return filteredCustomeres}function checkIfContainsArrayElement(c,a){for(var b=0;b<a.length;b++){if((" "+c).indexOf(" "+a[b]+" ")>=0){return a[b]}}return null}function clearCustomerBanner(){$("#customerDetailsGrid").hide();hideCustomerBanner();activeLocationDetails=null;activePlaceDetails=null}function showCustomerBanner(){$("#placeBanner").show("fast");$("#customerBanner").show("fast");$("#searchCloseButton")[0].value="\u25c4";$("#searchCloseButton").jqxToggleButton("check")}function hideCustomerBanner(){$("#placeBanner").hide("fast");$("#customerBanner").hide("fast");$("#searchCloseButton")[0].value="\u25ba";$("#searchCloseButton").jqxToggleButton("unCheck")}function searchCloseButtonHandler(){var a=$("#searchCloseButton").jqxToggleButton("toggled");if(a){showCustomerBanner()}else{hideCustomerBanner()}}function removeActiveMarker(){if(activeMarker){activeMarker.setMap(null);activeMarker=null}}function mapResetButtonHandler(){hideCustomerBanner();removeActiveMarker();initMap(entryPosition,entryZoomLevel)}function initMap(d,c,b){var a={center:entryPosition,clickableIcons:true,zoom:entryZoomLevel,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:google.maps.ControlPosition.TOP_RIGHT}};if(d){a.center=d}if(c){a.zoom=c}mapHolder=new google.maps.Map(document.getElementById("mapContainer"),a);if(b){createMarkerCircles(b)}else{createMarkerCircles(nuoCustomers)}addMapMouseListeners()}function addMapMouseListeners(){mapHolder.addListener("click",function(c){c.stop();clearCustomerBanner();$("#searchBox").val("");if(c.placeId){stop();placeMarkerAndPanTo(c.latLng,c.placeId,false)}else{if(!geocoderHolder){geocoderHolder=new google.maps.Geocoder()}var a=function(e,d){if(d==="OK"){placeMarkerAndPanTo(c.latLng,e[0].place_id,false)}else{alert("Geocode was not successful for the following reason: "+d)}};var b={location:c.latLng};geocoderHolder.geocode(b,a)}});mapHolder.data.addListener("click",function(a){clearCustomerBanner();$("#searchBox").val("");placeMarkerAndPanTo(a.feature.getProperty("location"),null,true)})}function createMarkerCircles(a){var c={type:"FeatureCollection",features:a.map(function(e){var f=e.placeDetails.placeAddress.split(",");var d={type:"Feature",properties:{name:getCustomerInternalName(e.customerDetails),city:f[f.length-1].trim(),customerDetails:e.customerDetails,location:e.locationDetails},geometry:{type:"Point",coordinates:[e.locationDetails.lng,e.locationDetails.lat]},id:e.id};return d})};mapHolder.data.addGeoJson(c);mapHolder.data.setStyle(function(d){return{icon:b(d),title:d.getProperty("name")+" ("+d.getProperty("city")+")"}});function b(d){return{path:google.maps.SymbolPath.CIRCLE,fillColor:getMarkerColor(d),fillOpacity:0.95,scale:markerCircleSize,strokeColor:"black",strokeWeight:0.7}}}function getMarkerColor(c){var a=markerColorGreen;var f=Date.now();var e=getActivities(c.getProperty("customerDetails"));if(e&&e.children&&e.children.length>0){var d=e.children.filter(function(i){var g=null;var h=i.children.find(function(j){return j.property===colorCriStatusName});if(h){g=h.value}return h&&g&&g!==colorCriStatusComplete});if(d&&d.length>0){var b=null;d.forEach(function(h){var g=null;var i=h.children.find(function(j){return j.property===colorCriDateName});if(i&&i.value){g=i.value.toDateMillis()}if(g&&(!b||g<b.dateValue)){h.dateValue=g;b=h}});if(b){if(b.dateValue&&b.dateValue<f){a=markerColorRed}else{if(b.dateValue&&b.dateValue>f&&b.dateValue<f+(30*24*3600*1000)){a=markerColorOrange}}}}}return a}function getActivities(b){if(b){var a=b.find(function(c){return c.property===activityPropertyName});return a}else{null}}function getCustomerId(a){var b=getCustomer(a).id;return b}function getCustomer(a){var b=nuoCustomers.find(function(c){return getCustomerName(c.customerDetails)===getCustomerName(a)});return b}function getCustomerName(a){var b=a.find(function(c){return c.property==="Organisatienaam"}).value;return b}function getCustomerInternalName(a){var b=a.find(function(c){return c.property==="Interne naam"}).value;return b}function placeMarkerAndPanTo(b,c,d){if(b&&b.lat&&b.lng){removeActiveMarker();activeLocationDetails=JSON.parse(JSON.stringify(b));var e=findCustomerOnActiveLocation();if(e){$("#placeActionButton").val("Klant Opslaan");activePlaceDetails=e.placeDetails;updateCustomerPlaceDetails(e.customerDetails.customerName);updateCustomerDetails(e)}else{resetPlaceButtons();var a=new google.maps.Marker({map:mapHolder,position:b});activeMarker=a;if(c){getAndUpdatePlaceDetails(c)}}if(d){mapHolder.setZoom(searchZoomLevel);mapHolder.setCenter(b)}}}function getAndUpdatePlaceDetails(a){var c=null;if(a.latLng&&a.latLng.lat&&a.latLng.lng){c={placeId:a}}else{if(a&&a.length>0){c={placeId:a};if(!placesServiceHolder){placesServiceHolder=new google.maps.places.PlacesService(mapHolder)}c={placeId:a};var b=function(e,d){if(d==google.maps.places.PlacesServiceStatus.OK){activePlaceDetails={placeName:e.name,placeAddress:getAddress(e.address_components),placePhone:e.international_phone_number,placeWebsite:e.website,placeOpeningHours:e.opening_hours};updateCustomerPlaceDetails()}else{console.log("Received status '"+d+"' while finding details for "+a)}};placesServiceHolder.getDetails(c,b)}}}function updateCustomerPlaceDetails(b){if(activePlaceDetails){if(b){$("#placeName").html(b)}else{if(activePlaceDetails.placeName){$("#placeName").html(activePlaceDetails.placeName)}else{$("#placeName").html("Geen naam beschikbaar")}}if(activePlaceDetails.placeAddress){$("#placeAddress").html(activePlaceDetails.placeAddress)}else{$("#placeAddress").html("Geen adres beschikbaar")}if(activePlaceDetails.placePhone){$("#placePhone").html(activePlaceDetails.placePhone)}else{$("#placePhone").html("Geen telefoon beschikbaar")}if(activePlaceDetails.placeWebsite){$("#placeWebsite").html("<a href='"+activePlaceDetails.placeWebsite+"' target='_blank'>"+activePlaceDetails.placeWebsite+"</a>")}else{$("#placeWebsite").html("Geen website beschikbaar")}if(activePlaceDetails.placeOpeningHours&&activePlaceDetails.placeOpeningHours.open_now&&activePlaceDetails.placeOpeningHours.weekday_text){var a=activePlaceDetails.placeOpeningHours.weekday_text;a.unshift(a.pop());var c=-1;a=a.map(function(e){c+=1;return"<option value='"+c+"'>"+e+"</option>"}).join(" ")+"</select>";var d="";if(activePlaceDetails.placeOpeningHours.open_now){d+="<span>Nu geopend </span>";$("#placeWorkingHours").css("color","green")}else{d+="<span>Gesloten </span>";$("#placeWorkingHours").css("color","red")}d+="<select id = 'schedule'>"+a+"</select>";$("#placeWorkingHours").html(d);$("#schedule").val(new Date().getDay())}else{$("#placeWorkingHours").html("Geen openingstijden beschikbaar")}showCustomerBanner()}}function updateCustomerDetails(a){if(a){activeCustomerDetails=a.customerDetails}else{activeCustomerDetails=getNewCustomerDetails();activeCustomerDetails.find(function(b){return b.property=="Organisatienaam"}).value=activePlaceDetails.placeName;activeCustomerDetails.find(function(b){return b.property=="Interne naam"}).value=activePlaceDetails.placeName;document.getElementById("customerFilesButton").disabled=true;document.getElementById("deleteCustomerButton").disabled=true}$("#placeActionButton").val("Klant Opslaan");$("#deleteCustomerButton").show();$("#customerFilesButton").show();$("#customerDetailsGrid").show();refreshCustomerDetailsGrid()}function refreshCustomerDetailsGrid(){$("#customerDetailsGrid").jqxTreeGrid({source:getCustomersGridSource()});$("#customerDetailsGrid").jqxTreeGrid("updateBoundData")}function getCustomersGridSource(){var a={dataType:"json",dataFields:[{name:"id",type:"string"},{name:"property",type:"string"},{name:"value",type:"string"},{name:"type",type:"string"},{name:"sourceValues",type:"array"},{name:"children",type:"array"}],hierarchy:{root:"children"},localData:activeCustomerDetails};return new $.jqx.dataAdapter(a)}function getAddress(c){var a=c.find(function(h){return h.types[0].toLowerCase()==="street_number"});var d=c.find(function(h){return h.types[0].toLowerCase()==="route"});var g=c.find(function(h){return h.types[0].toLowerCase()==="locality"});var f=c.find(function(h){return h.types[0].toLowerCase()==="country"});var e=c.find(function(h){return h.types[0].toLowerCase()==="postal_code"});var b="";if(d&&d.long_name){b+=d.long_name+" "}if(a&&a.long_name){b+=a.long_name+", "}if(e&&e.long_name){b+=e.long_name+", "}if(g&&g.long_name){b+=g.long_name}if(f&&f.long_name){return b}}function loadCustomerDirWindow(a){var c=$(window).width();var e=$(window).height();var b=800;var d=500;$("#customerDirWindow").jqxWindow({width:b,height:d,isModal:true,resizable:true,autoOpen:false,position:{x:(c/2)-300,y:100},theme:jqWidgetThemeName});$("#customerDirWindow").jqxWindow("setTitle","Bestanden opgeslagen voor "+a);$("#customerFilePath").html("/");loadCustomerFilesTable(getFileList(""));$("#customerDirWindow").jqxWindow("open")}function getFileList(a){var b=[];var c=getCustomer(activeCustomerDetails);if(c){c.files.map(function(d){var f=d.fileName;var e={};if(!a||a.length==0||(f.indexOf(a)>=0&&f.length>a.length)){e.fileName=f;e.parentPath=a;if(f.indexOf("/",a.length)>=0){e.fileLabel=decodeURI(f.substring(a.length,f.indexOf("/",a.length+1)));e.filePath=f.substring(0,f.indexOf("/",a.length+1)+1);e.isDirectory=true;e.fileType="Map"}else{e.fileLabel=decodeURI(f.substring(a.length));e.filePath=f;e.isDirectory=false;if(e.fileLabel.indexOf(".")>0){e.isDirectory=false;e.fileType=e.fileLabel.substring(e.fileLabel.lastIndexOf(".")+1).toUpperCase()+" Bestand"}}e.author=d.author;e.sizeBytes=d.sizeBytes;e.dateCreated=new Date(parseInt(d.dateCreatedMillis));e.dateModified=new Date(parseInt(d.dateModifiedMillis));e.sizeBytes=parseInt(d.sizeBytes);e.sizeLabel=getSizeLabel(e.sizeBytes);return e}else{return e}}).filter(function(d){return d.fileLabel}).sort(function(d,e){if(d.dateModified>e.dateModified){return -1}if(d.dateModified<e.dateModified){return 1}return 0}).forEach(function(d){var e=b.find(function(f){return f.fileLabel===d.fileLabel});if(!e){b.push(d)}else{e.sizeBytes+=d.sizeBytes;e.sizeLabel=getSizeLabel(e.sizeBytes)}})}return b}function loadCustomerFilesTable(a){var b=[{text:"Bestandsnaam",dataField:"fileLabel",width:"40%",height:20},{text:"Auteur",dataField:"author",width:"10%",height:20},{text:"Grootte",dataField:"sizeLabel",width:"10%",cellsalign:"right",height:20},{text:"Type",dataField:"fileType",width:"15%",height:20},{text:"Datum Gewijzigd",dataField:"dateModified",width:"25%",height:20,cellsformat:"yyyy-MM-dd  HH:mm:ss.fff"}];renderJqxGrid("#customerFilesTable",a,b);$("#customerFilesTable").show();$("#customerFilePath").show()}function getSizeLabel(a){if(a>=1024*1024*1024*1024){return(a/1024/1024/1024/1024).toFixed(2)+" TB"}else{if(a>=1024*1024*1024){return(a/1024/1024/1024).toFixed(2)+" GB"}else{if(a>=1024*1024){return(a/1024/1024).toFixed(2)+" MB"}else{if(a>=1024){return(a/1024).toFixed(2)+" KB"}else{return a+" B"}}}}}function addCustomerTableEventHandlers(){$("#customerFileUpButton").on("click",function(b){var c=$("#customerFilesTable").jqxGrid("getrowdata",0);var a="";if(c.isDirectory){a=c.parentPath.substring(0,c.parentPath.length-1).substring(0,c.parentPath.substring(0,c.parentPath.lastIndexOf("/")).lastIndexOf("/")+1)}else{a=c.parentPath.substring(0,c.parentPath.substring(0,c.parentPath.lastIndexOf("/")).lastIndexOf("/")+1)}loadCustomerFilesTable(getFileList(a));if(a.length==0){$("#customerFilePath").html("/")}else{$("#customerFilePath").html(a)}$("#customerFilesTable").jqxGrid("clearselection")});$("#customerFilesTable").on("rowdoubleclick",function(d){var c=d.args.rowindex;var f=$("#customerFilesTable").jqxGrid("getrowdata",c);if(f.isDirectory){loadCustomerFilesTable(getFileList(f.filePath));$("#customerFilePath").html(f.filePath);if(f.filePath.length==0){$("#customerFilePath").html("/")}}else{var a=f.fileLabel;if(!a.endsWith(systemFileLabel)){var b=f.parentPath;if(b&&b.length>0&&b!=="/"){a=b+a}var e=getCustomerId(activeCustomerDetails);if(e){a="CRM/UserFiles/"+e+"/"+a}directCall("rt11","NuoFileContent",{FileName:a}).done(function(h){if(h.StatusCode&&h.StatusCode===200){var g=document.getElementById("downloadTag");g.setAttribute("href",h.Content);g.click()}else{window.location="https://avab.nuocanvas.ai"}})}}$("#customerFilesTable").jqxGrid("clearselection")})}function renderJqxGrid(c,a,h,d,b){var e={localData:a,dataType:"json"};var g=new $.jqx.dataAdapter(e);var f={columnsResize:true,altRows:false,sortable:true,selectionMode:"multiplerows",source:g,columns:h,width:"100%",height:400,autoheight:true,autorowheight:true,scrollmode:"logical",theme:jqWidgetThemeName};if(b){f.editable=true}if(d){f.pageable=true;f.pagerMode="advanced"}$(c).jqxGrid(f)}function createCustomerDetailsGrid(){var a=function(g,d,f,e){var c='<div class="tooltip">'+f+"</div>";return c};$("#customerDetailsGrid").jqxTreeGrid({source:getCustomersGridSource(),width:"98%",altRows:true,autoRowHeight:false,editable:true,editSettings:{saveOnPageChange:true,saveOnBlur:true,saveOnSelectionChange:true,cancelOnEsc:true,saveOnEnter:true,editSingleCell:true,editOnDoubleClick:true,editOnF2:true},showHeader:true,ready:function(){$(".tooltip").jqxTooltip({position:"mouse",content:$(this).text()});b()},columnsResize:true,columns:[{text:"Attribuut",dataField:"property",width:"40%",height:15,columnType:"custom",editable:true,createEditor:function(j,d,h,f,g,c){var i=$("#customerDetailsGrid").jqxTreeGrid("getRow",j);var e=$("<input id='textbox"+j+"' class='textbox' style='border: none;'/>").appendTo(h);h.jqxInput({width:"100%",height:"100%"})},initEditor:function(i,d,f,g,e,c){var h=$("#customerDetailsGrid").jqxTreeGrid("getRow",i);f.children(0).val(d)},getEditorValue:function(f,c,d){var e=$("#customerDetailsGrid").jqxTreeGrid("getRow",f);return d.children(0).val()}},{text:"Waarde",dataField:"value",width:"60%",height:15,columnType:"custom",editable:true,cellsRenderer:a,createEditor:function(g,d,f,l,c,j){var k=$("#customerDetailsGrid").jqxTreeGrid("getRow",g);switch(k.type){case"hide":break;case"string":var h=$("<input id='textbox"+g+"' class='textbox' style='border: none;'/>").appendTo(f);f.jqxInput({width:"100%",height:"100%"});break;case"array":if(k.sourceValues){f.jqxDropDownList({autoDropDownHeight:true,source:k.sourceValues,width:"100%",height:"100%"});f.jqxDropDownList({placeHolder:"Selecteer",enableBrowserBoundsDetection:true});f.jqxDropDownList("selectItem",k.value)}break;case"date":var e=$("<div class='dropDownButton"+g+"' style='border: none;'><div style='padding: 5px;'><div class='datePicker"+g+"'></div></div></div>");e.appendTo(f);e.jqxDropDownButton({width:"100%",height:"100%",dropDownVerticalAlignment:"top"});var i=$($.find(".datePicker"+g));if(k.value){i.jqxDateTimeInput({value:new Date(k.value.toDateMillis()),showFooter:true});e.jqxDropDownButton("setContent",k.value)}else{i.jqxDateTimeInput({showFooter:true});e.jqxDropDownButton("setContent",new Date())}i.on("change",function(n){var m=n.args.date;e.jqxDropDownButton("setContent",m)});break}},initEditor:function(i,d,f,g,e,c){var h=$("#customerDetailsGrid").jqxTreeGrid("getRow",i);switch(h.type){case"string":f.children(0).val(d);break;case"date":f.jqxDropDownButton("setContent",d);break;case"array":f.jqxDropDownList("selectItem",d)}},getEditorValue:function(g,c,d){var f=$("#customerDetailsGrid").jqxTreeGrid("getRow",g);switch(f.type){case"string":return d.children(0).val();break;case"date":return $($.find(".datePicker"+g)).val();break;case"array":var e=d.jqxDropDownList("getSelectedItem");if(e){return e.label}else{return c}}}}]});$("#customerDetailsGrid").on("rowClick rowExpand rowCollapse",function(c){b()});function b(){$(".tooltip").jqxTooltip({position:"mouse",content:$(this).text()});$(".tooltip").on("mouseenter",function(){$(this).jqxTooltip({position:"mouse",content:$(this).text()})})}$("#customerDetailsGrid").on("contextmenu",function(){return false});$("#customerSettingsButton").on("click",customerSettingsClickHandler);$("#customerDetailsGrid").on("rowClick",customerGridRightClickHandler);$("#activityMenu").on("itemclick",customerGridContextMenuHandler)}function customerSettingsClickHandler(b){var c=$(window).scrollTop();var d=$(window).scrollLeft();var a=$("#activityMenu").jqxMenu({width:300,height:135,autoOpenPopup:false,mode:"popup"});a.jqxMenu("open",parseInt(b.clientX)+5+d,parseInt(b.clientY)+5+c);return false}function customerGridRightClickHandler(c){var a=c.args;if(a.originalEvent.button==2){var d=$(window).scrollTop();var f=$(window).scrollLeft();var e=120;var b=$("#activityMenu").jqxMenu({width:300,height:135,autoOpenPopup:false,mode:"popup"});b.jqxMenu("open",parseInt(c.args.originalEvent.clientX)+5+f,parseInt(c.args.originalEvent.clientY)+5+d-e);return false}}function isRightClick(b){var a;if(!b){var b=window.event}if(b.which){a=(b.which==3)}else{if(b.button){a=(b.button==2)}}return a}function customerGridContextMenuHandler(f){var c=f.args;var e=$("#customerDetailsGrid").jqxTreeGrid("getSelection");var d=$.trim($(c).text());if(d=="Attribuut Verwijderen"){e.forEach(function(i){$("#customerDetailsGrid").jqxTreeGrid("deleteRow",i.uid)})}else{var h=e[0];$("#customerDetailsGrid").jqxTreeGrid("expandRow",h.uid);var b={id:Date.now()+"_s_"+activeUsername,property:"Status",value:"Onbekend",type:"array",sourceValues:["Onbekend","Gepland","Opgeleverd"]};var a={id:Date.now()+"_p0_"+activeUsername,property:"Nieuw Product",value:"",type:"string",children:[{id:Date.now()+"_p00_"+activeUsername,property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Brandblusser 1","Brandblusser 2","Brandblusser 3","Brandblusser 4","EHBO Kit","Nooduitgang","RI&E","Evacuatieplan"]},{id:Date.now()+"_p01_"+activeUsername,property:"Aantal Producten",value:"0",type:"string"},{id:Date.now()+"_p02_"+activeUsername,property:"Prijs per Eenheid",value:"0",type:"string"}]};var g={id:Date.now()+"_a0_"+activeUsername,property:"Nieuwe Activiteit",value:"",type:"string",children:[{id:Date.now()+"_a00_"+activeUsername,property:"Uitvoeringsdatum",value:"",type:"date"},b,a]};switch(d){case"Nieuw Tekst Attribuut":addPropertyToActiveCustomer(h,h.id,{id:Date.now()+"_"+activeUsername,property:"Nieuwe Tekst Attribuut",value:"",type:"string"});break;case"Nieuw Datum Attribuut":addPropertyToActiveCustomer(h,h.id,{id:Date.now()+"_"+activeUsername,property:"Nieuwe Datum Attribuut",value:"",type:"date"});break;case"Nieuwe Activiteit":addPropertyToActiveCustomer(h,h.id,g);break;case"Nieuw Product Attribuut":addPropertyToActiveCustomer(h,h.id,a);break;case"Nieuw Status Attribuut":addPropertyToActiveCustomer(h,h.id,b);break}}}function addPropertyToActiveCustomer(e,f,g){var d=e.uid;if(activeCustomerDetails){var c=null;for(var b=0;c==null&&b<activeCustomerDetails.length;b++){var a=findProperty(f,activeCustomerDetails[b]);if(a){c=a}}if(c){if(!c.children){c.children=[]}c.children.push(g);refreshCustomerDetailsGrid();$("#customerDetailsGrid").jqxTreeGrid("collapseAll");expandRow(e)}}}function findProperty(d,b){if(b){if(b.id===d){return b}else{if(b.children&&b.children.length>0){for(var c=0;c<b.children.length;c++){var a=findProperty(d,b.children[c]);if(a){return a}}}}}return null}function expandRow(a){$("#customerDetailsGrid").jqxTreeGrid("expandRow",a.uid);if(a.parent){expandRow(a.parent)}}function getNewCustomerDetails(){var a=[{id:"96",property:"Organisatienaam",value:"",type:"string"},{id:"97",property:"Interne naam",value:"",type:"string"},{id:"98",property:"Relatiecode",value:"",type:"string"},{id:"99",property:"Relatietype",value:"Onbekend",type:"array",sourceValues:["Onbekend","Contactpersoon","Leverancier","Klant","Zakelijke partner","Medewerker"]},{id:"100",property:"Contactpersoon",value:"",type:"string",children:[{id:"101",property:"Naam",value:"",type:"string"},{id:"102",property:"Functie",value:"",type:"string"},{id:"103",property:"Mobiele Telefoon",value:"",type:"string"},{id:"104",property:"E-mail",value:"",type:"string"}]},{id:"105",property:"Voorkeursadres",value:"Onbekend",type:"array",sourceValues:["Onbekend","bezoekadres","factuuradres","postadres"]},{id:"106",property:"Telefoonnummer",value:"",type:"string"},{id:"107",property:"E-mail",value:"",type:"string"},{id:"108",property:"Fax",value:"",type:"string"},{id:"109",property:"Website",value:"",type:"string"},{id:"110",property:"Bezoekadres",value:"",type:"string",children:[{id:"111",property:"Straat",value:"",type:"string"},{id:"112",property:"Nummer",value:"",type:"string"},{id:"113",property:"Toevoeging",value:"",type:"string"},{id:"114",property:"Postcode",value:"",type:"string"},{id:"115",property:"Plaats",value:"",type:"string"},{id:"116",property:"Land",value:"Nederland",type:"string"}]},{id:"117",property:"Postadres",value:"",type:"string",children:[{id:"118",property:"Straat",value:"",type:"string"},{id:"119",property:"Nummer",value:"",type:"string"},{id:"120",property:"Toevoeging",value:"",type:"string"},{id:"121",property:"Postcode",value:"",type:"string"},{id:"122",property:"Plaats",value:"",type:"string"},{id:"123",property:"Land",value:"Nederland",type:"string"}]},{id:"124",property:"Activiteiten",value:"",type:"string",children:[{id:"125",property:"Activiteit1",value:"",type:"string",children:[{id:"126",property:"Uitvoeringsdatum",value:"",type:"date"},{id:"127",property:"Status",value:"Onbekend",type:"array",sourceValues:["Onbekend","Gepland","Opgeleverd"]},{id:"128",property:"Product1",value:"",type:"string",children:[{id:"129",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"130",property:"Aantal Producten",value:"0",type:"string"},{id:"131",property:"Prijs per Eenheid",value:"0",type:"string"}]},{id:"132",property:"Product2",value:"",type:"string",children:[{id:"133",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"134",property:"Aantal Producten",value:"0",type:"string"},{id:"135",property:"Prijs per Eenheid",value:"0",type:"string"}]},{id:"136",property:"Product3",value:"",type:"string",children:[{id:"137",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"138",property:"Aantal Producten",value:"0",type:"string"},{id:"139",property:"Prijs per Eenheid",value:"0",type:"string"}]}]},{id:"140",property:"Activiteit2",value:"",type:"string",children:[{id:"141",property:"Uitvoeringsdatum",value:"",type:"date"},{id:"142",property:"Status",value:"Onbekend",type:"array",sourceValues:["Onbekend","Gepland","Opgeleverd"]},{id:"143",property:"Product1",value:"",type:"string",children:[{id:"144",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"145",property:"Aantal Producten",value:"0",type:"string"},{id:"146",property:"Prijs per Eenheid",value:"0",type:"string"}]},{id:"147",property:"Product2",value:"",type:"string",children:[{id:"148",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"149",property:"Aantal Producten",value:"0",type:"string"},{id:"150",property:"Prijs per Eenheid",value:"0",type:"string"}]},{id:"151",property:"Product3",value:"",type:"string",children:[{id:"152",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"153",property:"Aantal Producten",value:"0",type:"string"},{id:"154",property:"Prijs per Eenheid",value:"0",type:"string"}]}]},{id:"155",property:"Activiteit3",value:"",type:"string",children:[{id:"156",property:"Uitvoeringsdatum",value:"",type:"date"},{id:"157",property:"Status",value:"Onbekend",type:"array",sourceValues:["Onbekend","Gepland","Opgeleverd"]},{id:"158",property:"Product1",value:"",type:"string",children:[{id:"159",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"160",property:"Aantal Producten",value:"0",type:"string"},{id:"161",property:"Prijs per Eenheid",value:"0",type:"string"}]},{id:"162",property:"Product2",value:"",type:"string",children:[{id:"163",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"164",property:"Aantal Producten",value:"0",type:"string"},{id:"165",property:"Prijs per Eenheid",value:"0",type:"string"}]},{id:"166",property:"Product3",value:"",type:"string",children:[{id:"167",property:"Product Naam",value:"Onbekend",type:"array",sourceValues:["Onbekend","Jaarlijks onderhoud brandveiligheidsunits","Jaarlijks onderhoud Brandmeldinstallatie","Jaarlijks onderhoud brandblusmiddelen ","Maandelijkse controle Brandmeldinstallatie","EHBO Kit","Nooduitgang","RI&E","Ontruimingsplan","BHV cursus","BHV cursus (herhaling)"]},{id:"168",property:"Aantal Producten",value:"0",type:"string"},{id:"169",property:"Prijs per Eenheid",value:"0",type:"string"}]}]}]},{id:"170",property:"Status",value:"Onbekend",type:"array",sourceValues:["Onbekend","Actief","Inactief"]},{id:"171",property:"Financieel",value:"",type:"string",children:[{id:"172",property:"Debiteurnummer",value:"",type:"string"},{id:"173",property:"Factuuradres",value:"",type:"string",children:[{id:"174",property:"Straat",value:"",type:"string"},{id:"175",property:"Nummer",value:"",type:"string"},{id:"176",property:"Toevoeging",value:"",type:"string"},{id:"177",property:"Postcode",value:"",type:"string"},{id:"178",property:"Plaats",value:"",type:"string"},{id:"179",property:"Land",value:"Nederland",type:"string"}]},{id:"180",property:"Bank",value:"",type:"string",children:[{id:"181",property:"Naam",value:"",type:"string"},{id:"182",property:"IBAN",value:"",type:"string"},{id:"183",property:"BIC",value:"",type:"string"}]}]},{id:"184",property:"Typering",value:"",type:"string",children:[{id:"185",property:"Bedrijfsactiviteit",value:"",type:"string"},{id:"186",property:"Branche",value:"Onbekend",type:"array",sourceValues:["Onbekend","A. Landbouw bosbouw en visserij","B. Winning van delfstoffen","C. Industrie","D. Productie en distributie van en handel in electiciteit, aardgas, stoom, en gekoelde lucht","E. Winning en distributievan water; afval- en afvalwaterbeheer en saneringen","F. Bouwnijverheid","G. Groothandel en detailhandel; reparatie van auto's","H. Vervoer en opslag","I. Logies-, maaltijd- en drankverstrekking","J. Informatie en communicatie","K. Financiele instelling","L. Verhuurd van en handel in onroerend goed","M. Advisering, onderzoek, van overige specialistische zakelijke dienstverlening","N. Verhuurd van roerende goederen en overige zakelijke dienstverlening","O. Openbaar bestuur, overheidsdiensten en verplichte socialte verzekerninge","P. Onderwijs","Q. Gezondheidszorg","R. Cultuur, sport en recreatie"]},{id:"187",property:"Aantal medewerkers",value:"",type:"string"}]},{id:"188",property:"Identificatie",value:"",type:"string",children:[{id:"189",property:"KvK nummer",value:"",type:"string"},{id:"190",property:"Rechtsvorm",value:"Onbekend",type:"array",sourceValues:["Onbekend","Besloten Vennootschap","Eenmanszaak","Naamloze Vennootschap","Publieksrechtelijk Lichaam","Stichting","Vennootschap onder Firma","Vereniging"]}]}];return a}String.prototype.initCap=function(){return this.toLowerCase().replace(/(?:^|\s)[a-z]/g,function(a){return a.toUpperCase()})};function removeConsecutiveWS(a){var b=a;while(b.indexOf("  ")>=0){b=b.replace("  "," ")}return b}function standardize(a){var b=a.toLowerCase();while(b.indexOf(" ")>=0){b=b.replace(" ","")}return b}String.prototype.toDateMillis=function(){if(/^\d{1,2}\/\d{1,2}\/\d{2,4}$/.test(this)){var a=this.split("/");return new Date(a[2],a[1]-1,a[0]).getTime()}else{return null}};String.prototype.toNumber=function(){if(/^-?\d*\.\d*$/.test(this)){return parseFloat(this)}else{return null}};function updateAttrId(a){a.id=counter+"";counter+=1;if(a.children&&a.children.length>0){var b=a.children.map(function(c){return updateAttrId(c)});a.children=b}return a}var counter=1;getNewCustomerDetails().map(function(a){var b=updateAttrId(a);return b});